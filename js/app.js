var app=angular.module("app",["ngRoute","ngTouch","services"]),services=angular.module("services",[]);app.config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"views/home.php",controller:"homeCtrl"}).otherwise({redirectTo:"/"})}]),app.controller("allCtrl",function(){}),app.controller("homeCtrl",function($scope,$http,WindSpeed,Api){$scope.goSearch=!1,$scope.result=!1,$scope.hideResult=function(){$scope.result=!1};var numbersDaySup;$scope.search=function(city){$scope.searchCity.city.$error.minlength!==!0&&void 0!==city&&""!==city&&($scope.goSearch=!0,Api.get("http://api.openweathermap.org/data/2.5/find?q="+city+"&mode=json&units=metric&lang=fr&type=accurate").then(function(response){console.log(response),console.log(response.cod),$scope.goSearch=!1,"404"!==response.cod&&($scope.result=!0,$scope.cityDay=response.list[0].name,$scope.cityCountry=response.list[0].sys.country,$scope.temperatureDay=response.list[0].main.temp.toFixed(0),$scope.iconDayActif=response.list[0].weather[0].icon,$scope.dayActif=day(today.getDay()),$scope.dateActif=date(today.getDate(),today.getMonth(),today.getFullYear()),$scope.humidityDay=response.list[0].main.humidity.toFixed(0),$scope.pressureDay=response.list[0].main.pressure.toFixed(0),$scope.speedDay=WindSpeed.km(response.list[0].wind.speed).toFixed(0))}),Api.get("http://api.openweathermap.org/data/2.5/forecast/daily?q="+city+"&mode=json&units=metric&cnt=10&lang=fr&type=accurate").then(function(response){if(console.log(response),console.log(response.cod),"404"!==response.cod){numbersDaySup=0;for(var daysInfo=[],maxDays=response.list.length,i=0;maxDays>i;i++){var rainResponse;response.list[i].rain&&(rainResponse="Précipitations : "+response.list[i].rain+" mm"),daysInfo.push({day:findNextDay(i),date:findNextDate(i),temp:response.list[i].temp.max.toFixed(0),minTemp:response.list[i].temp.min.toFixed(0),icon:response.list[i].weather[0].icon,humidityOtherDay:response.list[i].humidity.toFixed(0),pressureOtherDay:response.list[i].pressure.toFixed(0),speedOtherDay:WindSpeed.km(response.list[i].speed).toFixed(0),rain:rainResponse})}$scope.days=daysInfo}}))};var today=new Date,days=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],months=[{name:"Janvier",limite:31},{name:"Février",limite:30},{name:"Mars",limite:31},{name:"Avril",limite:30},{name:"Mai",limite:31},{name:"Juin",limite:30},{name:"Juillet",limite:31},{name:"Août",limite:31},{name:"Septembre",limite:30},{name:"Octobre",limite:31},{name:"Novembre",limite:30},{name:"Décembre",limite:31}],day=function(number){return days[number]},date=function(numDay,numMonth,numYear){return numDay+" "+months[numMonth].name+" "+numYear},findNextDay=function(number){var startDay=today.getDay(),newDay=startDay+number+1;return newDay>6&&(newDay=number-3),day(newDay)},findNextDate=function(number){var startDate=today.getDate(),newDate=startDate+number+1,newMonth=today.getMonth(),limite=months[newMonth].limite,newYear=today.getFullYear();return newDate>limite&&(numbersDaySup++,newDate=numbersDaySup,newMonth+=1,11===newMonth&&(newMonth=0,newYear+=1)),date(newDate,newMonth,newYear)}}),app.directive("header",function(){return{restrict:"E",replace:"true",templateUrl:"views/header.php"}}),app.directive("footer",function(){return{retrict:"E",replace:"true",templateUrl:"views/footer.php",link:function(scope){scope.tab1=!0,scope.changeActive=function(){scope.tab1===!0?scope.tab1=!1:scope.tab1=!0}}}}),services.factory("WindSpeed",function(){var windSpeed={};return windSpeed.km=function(speed){var speedKm=3.6*speed;return speedKm},windSpeed}),services.factory("Api",function($http){var api={};return api.get=function(url){return $http({method:"GET",url:url}).then(function(response){return response.data})},api});