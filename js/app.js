var app=angular.module("app",["ngRoute","ngTouch"]);app.config(["$routeProvider",function($routeProvider){$routeProvider.when("/",{templateUrl:"views/home.php",controller:"homeCtrl"}).otherwise({redirectTo:"/"})}]),app.controller("allCtrl",function(){}),app.controller("homeCtrl",function($scope,$http){$scope.goSearch=!1,$scope.result=!1,$scope.hideResult=function(){$scope.result=!1},$scope.search=function(city){if($scope.searchCity.city.$error.minlength!==!0&&void 0!==city&&""!==city){$scope.goSearch=!0;var dayInfos=function(){var url="http://api.openweathermap.org/data/2.5/find?q="+city+"&mode=json&units=metric&lang=fr&type=accurate";api(url,"currentDay")};dayInfos();var dayInfos=function(){var url="http://api.openweathermap.org/data/2.5/forecast/daily?q="+city+"&mode=json&units=metric&cnt=10&lang=fr&type=accurate";api(url,"otherDays")};dayInfos()}};var numbersDaySup,api=function(url,typeDay){$http({method:"GET",url:url}).success(function(response){if($scope.goSearch=!1,console.log(response),console.log(response.cod),"404"!==response.cod)if($scope.result=!0,"currentDay"===typeDay)$scope.cityDay=response.list[0].name,$scope.cityCountry=response.list[0].sys.country,$scope.temperatureDay=response.list[0].main.temp.toFixed(0),$scope.iconDayActif=response.list[0].weather[0].icon,$scope.dayActif=day(today.getDay()),$scope.dateActif=date(today.getDate(),today.getMonth(),today.getFullYear()),$scope.humidityDay=response.list[0].main.humidity.toFixed(0),$scope.pressureDay=response.list[0].main.pressure.toFixed(0),$scope.speedDay=windSpeed(response.list[0].wind.speed).toFixed(0);else if("otherDays"===typeDay){numbersDaySup=0;for(var daysInfo=[],maxDays=response.list.length,i=0;maxDays>i;i++)daysInfo.push({day:findNextDay(i),date:findNextDate(i),temp:response.list[i].temp.day.toFixed(0),icon:response.list[i].weather[0].icon});$scope.days=daysInfo}}).error(function(headers,status,config){$scope.goSearch=!1,console.log(headers),console.log(status),console.log(config)})},today=new Date,days=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],months=[{name:"Janvier",limite:31},{name:"Février",limite:30},{name:"Mars",limite:31},{name:"Avril",limite:30},{name:"Mai",limite:31},{name:"Juin",limite:30},{name:"Juillet",limite:31},{name:"Août",limite:31},{name:"Septembre",limite:30},{name:"Octobre",limite:31},{name:"Novembre",limite:30},{name:"Décembre",limite:31}],day=function(number){return days[number]},date=function(numDay,numMonth,numYear){return numDay+" "+months[numMonth].name+" "+numYear},findNextDay=function(number){var startDay=today.getDay(),newDay=startDay+number+1;return newDay>6&&(newDay=number-4),day(newDay)},findNextDate=function(number){var startDate=today.getDate(),newDate=startDate+number+1,newMonth=today.getMonth(),limite=months[newMonth].limite,newYear=today.getFullYear();return newDate>limite&&(numbersDaySup++,newDate=numbersDaySup,11===newMonth&&(newMonth=0,newYear+=1)),date(newDate,newMonth,newYear)},windSpeed=function(speed){var speedKm=3.6*speed;return speedKm}}),app.directive("header",function(){return{restrict:"E",replace:"true",templateUrl:"views/header.php"}}),app.directive("footer",function(){return{retrict:"E",replace:"true",templateUrl:"views/footer.php",link:function(scope){scope.tab1=!0,scope.changeActive=function(){scope.tab1===!0?scope.tab1=!1:scope.tab1=!0}}}});